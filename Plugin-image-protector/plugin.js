var ImageProtect=function(t){$(function(){1==t.pinterest&&$("body").addClass("k-image-protect-nopin"),$("body").addClass("k-image-protect");var e=function(t){t=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);var e=function(t){return("0"+parseInt(t).toString(16)).slice(-2)};if(t)return e(t[1])+e(t[2])+e(t[3])},n=function(e){return!!$(e).hasClass("__overlay__")||(1!=t.states.visibility||!$(e).attr("data-visibility")||"public"===$(e).attr("data-visibility"))&&("all"==t.size||parseInt(e.getAttribute("data-longest-side"),10)>=parseInt(t.size,10))},o=function(){var e="";return 1==t.menu.copyright.prepend&&(e+="&copy;&nbsp;"),t.menu.copyright.message.length>0&&(e+=t.menu.copyright.message),e+=t.menu.message.length>0?(t.menu.copyright.message.length>0?"<br/>":"")+t.menu.message:""},i=function(){$(".koken_image_protect_context_menu").fadeOut(function(){$(this).remove()})},a=function(){return"k-lightbox"===$("body").attr("id")},s=function(e){$(".share-pinterest").each(function(t,e){var n=$(e).parent();"li"===n.get(0).tagName.toLowerCase()&&n.remove()}),$('[data-koken-share="pinterest"]').remove();var o=function(){var t=$(e),n=t.position(),o=$("<img/>").attr("src",$K.tgif),i=$(e).get(0).width.toString(),s=$(e).get(0).height.toString(),r=i&&i.indexOf("%")!==-1,c=s&&s.indexOf("%")!==-1;if(r||i||s)return a()||$(e).parent().find(".__overlay__").remove(".__overlay__"),o.width(r?$(e).parent().width():$(e).outerWidth()).height(c?$(e).parent().height():$(e).outerHeight()).css({position:"absolute",zIndex:998,"-webkit-touch-callout":"none","-webkit-user-select":"none",top:n.top-parseInt(t.parent().css("paddingTop"),10),left:n.left-parseInt(t.parent().css("paddingLeft"),10)}).attr("data-longest-side",e.getAttribute("data-longest-side")).addClass("__overlay__"),"none"!==$(e).css("maxWidth")&&o.css("maxWidth",$(e).css("maxWidth")),"none"!==$(e).css("maxHeight")&&o.css("maxHeight",$(e).css("maxHeight")),$(e).css({"-webkit-touch-callout":"none","-webkit-user-select":"none"}).before(o),$._data(e,"events")&&$.each($._data(e,"events"),function(){$.each(this,function(){"load"!==this.type&&o.bind(this.type,this.handler)})}),o};n(e)&&1==t.states.overlay&&($(e).data("overlay")?$(e).data("overlay").width($(e).attr("width")).height($(e).attr("height")):window.setTimeout(function(){$(e).data("overlay",o())}))};(t.theme.length<=0||"auto"===t.theme)&&(t.theme=parseInt(e($("body").css("backgroundColor")),16)>8388607.5?"light":"dark"),$("img[data-longest-side]").off(".imageProtect").on("load.imageProtect",function(){a()||s(this)}),$(window).off(".imageProtectWindow").on("k-infinite-loaded.imageProtectWindow",function(){$("img[data-longest-side]").on("load",function(){s(this)})}),$(document).off(".imageProtect").on("mousedown.imageProtect dragstart.imageProtect",".__overlay__",function(t){t.preventDefault()}).on("k-img-resize.imageProtect",function(t,e){s(e)}).on("k-image-loaded.imageProtect",function(t,e){s(e)}).on("koken:lightbox:imageloaded.imageProtect",function(t){s($(t.target).find("img").get(0)),i()}).on("built",function(t,e){e.dom.find(".video-container").length||s(e.dom.find("img").get(0))}).on("contextmenu.imageProtect",function(e){var a=this;"IMG"===e.target.nodeName&&n(e.target)&&(e.preventDefault(),1!=t.states.menu||$(".koken_image_protect_context_menu").length||($(".koken_image_protect_context_menu").remove(),$("<div/>").addClass(function(){var e="";return"custom"===t.theme&&1!=t.shadow||(e+=" shadow"),"custom"===t.theme&&1!=t.radius||(e+=" radius"),"koken_image_protect_context_menu "+t.theme+" "+e}).css({top:e.pageY+10+"px",left:e.pageX+"px",display:"none","font-size":("custom"===t.theme?t.menu.size:12)+"px"}).html(o()).appendTo("body").fadeIn(function(){$(this).attr("style",function(t,e){return e+" display: block !important;"}),$(a).off(".mm").on("mousemove.mm",function(){$(a).off(".mm"),window.setTimeout(i,75)})}),window.setTimeout(function(){var t=$(".koken_image_protect_context_menu");t.css("left",parseInt(t.css("left"),10)-t.width()/2-10+"px")},1)))})})};